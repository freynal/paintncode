jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,n,r,i){return jQuery.easing[jQuery.easing.def](e,t,n,r,i)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t+n;return-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t+n;return r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t*t+n;return-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t*t*t+n;return r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){if(t==0)return n;if(t==i)return n+r;if((t/=i/2)<1)return r/2*Math.pow(2,10*(t-1))+n;return r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){if((t/=i/2)<1)return-r/2*(Math.sqrt(1-t*t)-1)+n;return r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){var s=1.70158;var o=0;var u=r;if(t==0)return n;if((t/=i)==1)return n+r;if(!o)o=i*.3;if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return-(u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o))+n},easeOutElastic:function(e,t,n,r,i){var s=1.70158;var o=0;var u=r;if(t==0)return n;if((t/=i)==1)return n+r;if(!o)o=i*.3;if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return u*Math.pow(2,-10*t)*Math.sin((t*i-s)*2*Math.PI/o)+r+n},easeInOutElastic:function(e,t,n,r,i){var s=1.70158;var o=0;var u=r;if(t==0)return n;if((t/=i/2)==2)return n+r;if(!o)o=i*.3*1.5;if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);if(t<1)return-.5*u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)+n;return u*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)*.5+r+n},easeInBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;return r*(t/=i)*t*((s+1)*t-s)+n},easeOutBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;return r*((t=t/i-1)*t*((s+1)*t+s)+1)+n},easeInOutBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;if((t/=i/2)<1)return r/2*t*t*(((s*=1.525)+1)*t-s)+n;return r/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+n},easeInBounce:function(e,t,n,r,i){return r-jQuery.easing.easeOutBounce(e,i-t,0,r,i)+n},easeOutBounce:function(e,t,n,r,i){if((t/=i)<1/2.75){return r*7.5625*t*t+n}else if(t<2/2.75){return r*(7.5625*(t-=1.5/2.75)*t+.75)+n}else if(t<2.5/2.75){return r*(7.5625*(t-=2.25/2.75)*t+.9375)+n}else{return r*(7.5625*(t-=2.625/2.75)*t+.984375)+n}},easeInOutBounce:function(e,t,n,r,i){if(t<i/2)return jQuery.easing.easeInBounce(e,t*2,0,r,i)*.5+n;return jQuery.easing.easeOutBounce(e,t*2-i,0,r,i)*.5+r*.5+n}});(function(e){e.fn.visible=function(t){if(!e(this).offset())return true;var n=e(this),r=e(window),i=r.scrollTop(),s=i+r.height(),o=n.offset().top,u=o+n.height(),a=t===true?u:o,f=t===true?o:u;return f<=s&&a>=i};e.finalTilesGallery=function(t,n){function r(){var e=document.body||document.documentElement;var t=e.style;var n="transition";if(typeof t[n]=="string"){return true}v=["Moz","Webkit","Khtml","O","ms"],n=n.charAt(0).toUpperCase()+n.substr(1);for(var r=0;r<v.length;r++){if(typeof t[v[r]+n]=="string"){return true}}return false}var i=function(e,t,n){this.position={x:0,y:0};this.blocks={h:Math.floor(t/e),v:Math.floor(n/e)};this.size={width:this.blocks.h*e,height:this.blocks.v*e};this.px={width:t,height:n};this.cell_size=e;this.edge_right=false};i.prototype.resize=function(e,t){var n=e*this.cell_size;var r=n*this.px.height/this.px.width;var i=this.blocks.v;this.blocks.h=e;if(!t)this.blocks.v=Math.floor(r/this.cell_size)};var s=function(e,t,n,r){this.slots=[];this.cells=[];this.margin=t;this.min_tile_width=n;this.cell_size=e;this.width=r;this.hor_size=Math.floor(r/e);this.init()};s.prototype.init=function(){this.slots.length=0;this.cells.length=0;for(var e=0;e<this.hor_size*100;e++){this.cells[e]=0}};s.prototype.add_slot=function(e){for(var t=0;t<e.blocks.v;t++){for(var n=0;n<e.blocks.h;n++){var r=e.position.y+t;var i=e.position.x+n;this.cells[r*this.hor_size+i]=1;this.cells.push(0)}}this.slots.push(e)};s.prototype.count_free_cells_on_right=function(e){var t=Math.floor(e/this.hor_size);var n=(t+1)*this.hor_size;var r=0;for(;e<n;e++,r++){if(this.cells[e]==1){break}}return r};s.prototype.insert=function(e,t,n){var r=new i(this.cell_size,e,t);var s=0;var o=0;var a=0;if(this.slots.length==0){s=this.hor_size;r.position.x=0;r.position.y=0}else{var f=false;for(;o<this.cells.length;o++){if(this.cells[o]==0){a=Math.floor(o/this.hor_size);var l=(a+1)*this.hor_size;s=0;for(var c=0;c<=l-o;c++){s=c;if(this.cells[o+c]==1){break}}break}}}if(s<r.blocks.h){r.resize(s)}else{var h=this.count_free_cells_on_right(o+r.blocks.h);if(h*this.cell_size-u.settings.margin<this.min_tile_width&&h>0){r.resize(s,!n);r.enlarged=true}if(h==0)r.edge_right=true}r.position.x=o%this.hor_size;r.position.y=Math.floor(o/this.hor_size);this.add_slot(r);return r};s.prototype.print=function(){var t="";for(var n=1;n<=this.cells.length;n++){t+=this.cells[n-1]==1?"¦¦":"__";if(n>0&&n%this.hor_size==0)t+="\n"}e("pre").text(t)};var o={margin:10,minTileWidth:200,autoLoadURL:null,autoLoadOffset:50,gridCellSize:10,scrollEffect:"zoom",enableTwitter:false,twitterText:"",enableFacebook:false,facebookText:"",enableGplus:false,enablePinterest:false,allowEnlargement:true,hoverEffect:"fade",hoverEasing:"swing",hoverEffectDuration:250,ignoreImageAttributes:true,imageSizeFactor:1,onComplete:function(){},onUpdate:function(){}};var u=this;var a=null;var f=r();var l=false;var c=false;var h=1;var p=false;var d=0;u.settings={};var m=e(t),t=t;var g=m.width();var y=false;var b=function(){if(m.find(".ftg-filters").length==0)return;m.find(".ftg-filters a").click(function(t){t.preventDefault();l=true;d=0;if(e(this).hasClass("selected"))return;m.find(".ftg-filters .selected").add(this).toggleClass("selected");var n=e(this).attr("href").substr(1);var r=e("void");a=null;if(n.length>0){m.find(".tile").addClass("ftg-hidden").hide().css({bottom:0,left:"50%"});r=m.find(".ftg-"+n).show().removeClass("ftg-hidden")}else{r=m.find(".tile").removeClass("ftg-hidden").show()}_(r)})};u.addElements=function(t){var n=e("<div />").hide();n.append(t);var r=n.find(".tile");k(r,{top:e(window).scrollTop()+500});w(r);e("body").append(n);r.appendTo(m.find(".ftg-items"));n.remove();A(r)};u.showLoading=function(){var t=e("<div class='ftg-loading-panel' />");t.append("<p>Loading</p>");t.hide();e("body").append(t);t.fadeIn()};u.hideLoading=function(){e(".ftg-loading-panel").fadeOut("fast",function(){e(this).remove()})};u.init=function(){u.settings=e.extend({},o,n);m.find(".ftg-items").css({position:"relative",minWidth:u.settings.minTileWidth});var t=m.find(".tile");k(t);b();A(t);p=u.settings.enableFacebook||u.settings.enableGplus||u.settings.enableTwitter||u.settings.enablePinterest;if(p)w(t);var r=0;e(window).resize(function(){clearTimeout(r);if(g!=m.width()){r=setTimeout(function(){a=null;d=0;l=true;_(m.find(".tile"))},200)}});var i=e(".tile");e(window).scroll(function(e){i.each(function(e,t){var n=i.eq(e);if(n.visible(true)){i.splice(e,1);n.addClass("effect-"+u.settings.scrollEffect).removeClass("module")}})});var s=false;if(u.settings.autoLoadURL){e(window).scroll(function(){if(!s&&!c&&e(window).scrollTop()>=e(document).height()-e(window).height()-u.settings.autoLoadOffset){c=true;u.showLoading();e.get(u.settings.autoLoadURL,{page:++h},function(t){if(e.trim(t).length==0){s=true}else{u.addElements(t)}})}})}};var w=function(t){t.each(function(t,n){var r=e(n);r.append("<div class='ftg-social' />")});if(u.settings.enableTwitter)x(t);if(u.settings.enableFacebook)T(t);if(u.settings.enableGplus)C(t);if(u.settings.enablePinterest)N(t)};var E=function(t,n,r){t.find(".ftg-social").each(function(t,r){var i=e(r);var s=e("<a class='"+n+"' href='#'></a>");i.append(s)})};var S=function(e){var t=document.createElement("img");t.src=e;e=t.src;t.src=null;return e};var x=function(t){E(t,"tw-icon fa fa-twitter","Twitter");t.find(".tw-icon").click(function(t){t.preventDefault();var n=e(this).parents(".tile:first").find(".caption");var r=u.settings.twitterText||document.title;if(!u.settings.twitterText&&n.length==1&&n.text().length>0)r=e.trim(n.text());var i=window.open("https://twitter.com/intent/tweet?url="+encodeURI(location.href.split("#")[0])+"&text="+encodeURI(r),"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");i.moveTo(screen.width/2-300,screen.height/2-200)})};var T=function(t){E(t,"fb-icon fa fa-facebook","Facebook");t.find(".fb-icon").click(function(t){t.preventDefault();var n=e(this).parents(".tile:first").find("img.item");var r=e(this).parents(".tile:first").find(".caption");var i=u.settings.facebookText||document.title;if(!u.settings.facebookText&&r.length==1&&r.text().length>0)i=e.trim(r.text());var s="http://www.facebook.com/sharer.php?u="+encodeURI(location.href.split("#")[0])+"&t="+encodeURI(i);if(n.length==1){var o=n.attr("src");s+="&p[images][0]="+S(o)}var a=window.open(s,"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");a.moveTo(screen.width/2-300,screen.height/2-200)})};var N=function(t){E(t,"pi-icon fa fa-pinterest","Pinterest");t.find(".pi-icon").click(function(t){t.preventDefault();var n=e(this).parents(".tile:first").find("img.item");var r=e(this).parents(".tile:first").find(".caption");var i=u.settings.facebookText||document.title;if(!u.settings.facebookText&&r.length==1&&r.text().length>0)i=e.trim(r.text());var s="http://pinterest.com/pin/create/button/?url="+encodeURI(location.href)+"&description="+encodeURI(i);if(n.length==1){var o=n.attr("src");s+="&media="+S(o)}var a=window.open(s,"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");a.moveTo(screen.width/2-300,screen.height/2-200)})};var C=function(e){E(e,"gp-icon fa fa-google-plus","G+");e.find(".gp-icon").click(function(e){e.preventDefault();var t="https://plus.google.com/share?url="+encodeURI(location.href);var n=window.open(t,"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");n.moveTo(screen.width/2-300,screen.height/2-200)})};var k=function(e,t){e.css({position:"absolute",left:"50%"});if(t){for(var n in t){e.css(n,t[n])}}e.find(".tile-inner").css({position:"relative"});e.find(".item").css({width:"100%",display:"none"})};var L=function(t){var n=e(t.shift());if(n.data("type")==null||n.data("type")=="image"){var r=n.find(".item");var i=new Image;if(r.attr("width")&&r.attr("height")&&!u.settings.ignoreImageAttributes){M(n);_(n);O(n);if(t.length>0)L(t)}else{i.onload=function(){n.find(".item").data("width",this.width*u.settings.imageSizeFactor).data("height",this.height*u.settings.imageSizeFactor);M(n);_(n);O(n);if(t.length>0)L(t)};i.onerror=function(){M(n);_(n);O(n);if(t.length>0)L(t)};i.src=r.attr("src")}}else{M(n);_(n);O(n);if(t.length>0)L(t)}};var A=function(e){var t=[];e.each(function(e,n){t.push(n)});L(t)};var O=function(e){var t=e.find(".caption");if(t.length>0){t.css({position:"absolute",width:"100%",height:"100%",opacity:0});var n={enter:{},leave:{}};switch(u.settings.hoverEffect){default:case"fade":t.css({left:0,top:0});n.enter.opacity=1;n.leave.opacity=0;break;case"slide-top":t.css({left:0,top:0-e.find(".item").data("size").height});n.enter.top=0;n.leave.top=0-e.find(".item").data("size").height;n.enter.opacity=1;n.leave.opacity=0;break;case"slide-bottom":t.css({left:0,bottom:0-e.find(".item").data("size").height});n.enter.bottom=0;n.leave.bottom=0-e.find(".item").data("size").height;n.enter.opacity=1;n.leave.opacity=0;break;case"slide-left":t.css({left:0-e.find(".item").data("size").width,top:0});n.enter.left=0;n.leave.left=0-e.find(".item").data("size").width;n.enter.opacity=1;n.leave.opacity=0;break;case"slide-right":t.css({right:0-e.find(".item").data("size").width,top:0});n.enter.right=0;n.leave.right=0-e.find(".item").data("size").width;n.enter.opacity=1;n.leave.opacity=0;break}e.mouseenter(function(){t.css("display","block");t.animate(n.enter,u.settings.hoverEffectDuration,u.settings.hoverEasing,function(){})});e.mouseleave(function(){t.animate(n.leave,u.settings.hoverEffectDuration,u.settings.hoverEasing,function(){})})}};var M=function(t){t.each(function(){var t={};var n=e(this).find(".item");if(e(this).data("type")==null||e(this).data("type")=="image"){if(n.attr("width")){t={width:parseInt(n.attr("width")),height:parseInt(n.attr("height"))}}else{n.show();t={width:n.data("width"),height:n.data("height")}}n.hide()}if(e(this).data("type")=="video"){t={width:parseInt(e(this).find("iframe").attr("width")),height:parseInt(e(this).find("iframe").attr("height"))}}n.data("size",t)})};var _=function(t){if(!a)a=new s(u.settings.gridCellSize,u.settings.margin,u.settings.minTileWidth,m.width());var n=l?"all .5s":"none";t.css({transition:n});t.find(".item").css({display:"block"});t.each(function(){if(e(this).hasClass("ftg-hidden"))return;e(this).show();var t=e(this).find(".item").data("size");var n=a.insert(t.width+u.settings.margin,t.height+u.settings.margin,u.settings.allowEnlargement);e(this).data("enlarged",n.enlarged);e(this).find(".caption").css({width:"100%"});var i=n.cell_size*n.position.y;var s=n.cell_size*n.blocks.v;var o=n.cell_size*n.blocks.h-u.settings.margin;var f=n.cell_size*n.blocks.v-u.settings.margin;if(i+f>d)d=i+s+u.settings.margin;if(r()||!l){e(this).css({top:i,left:n.cell_size*n.position.x,width:n.cell_size*n.blocks.h,height:s},500);e(this).find(".tile-inner").css({display:"block",overflow:"hidden"}).css({width:o,height:f}).data("width",o).data("height",f)}else{e(this).animate({top:i,left:n.cell_size*n.position.x,width:n.cell_size*n.blocks.h,height:s},500);e(this).find(".tile-inner").css({display:"block",overflow:"hidden"}).animate({width:o,height:f}).data("width",o).data("height",f)}m.find(".ftg-items").height(d)});t.find("img.item").each(function(t,n){var r=e(n);var i=r.data("size");r.css({marginTop:0,marginLeft:0,width:"100%",display:"block",fontSize:10,margin:"auto",maxWidth:"9999em"});var s=i.width/i.height;var o=r.parent().data("width")/r.parent().data("height");if(r.parent().parent().data("enlarged")&&!u.settings.allowEnlargement){r.css({height:r.parent().data("height"),width:i.width,marginTop:0})}else if(s==o){r.css({width:r.parent().data("width"),height:r.parent().data("height")});r.attr("case","0");return}else if(s>=o){r.css({width:"auto",height:r.parent().data("height")});r.attr("case","2");var a=r.parent().data("height")*i.width/i.height;var f=a-r.parent().data("width");r.css("margin-left",f/-2)}else{r.css({width:r.parent().data("width"),height:"auto"});r.attr("case","4");var l=r.parent().data("width")*i.height/i.width;var f=l-r.parent().data("height");r.css("margin-top",f/-2)}});t.each(function(){var t=e(this);if(t.visible(true)){t.addClass("already-visible")}});g=m.width();if(!y){y=true;u.settings.onComplete.call(u)}else{u.settings.onUpdate.call(u)}c=false;u.hideLoading()};u.init()};e.fn.finalTilesGallery=function(t){return this.each(function(){if(undefined==e(this).data("finalTilesGallery")){var n=new e.finalTilesGallery(this,t);e(this).data("finalTilesGallery",n)}})}})(jQuery)